<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MacroBuddy PWA</title>
    <link rel="stylesheet" href="css/index.css" />
    <link rel="manifest" href="manifest.json" />
    <!-- This script forces a reload if the page is loaded via the back/forward cache -->
    <script>
      // Using the pageshow event to detect when a page is loaded from cache.
      window.addEventListener('pageshow', function (event) {
        if (event.persisted) {
          window.location.reload();
        }
      });
      // Fallback using the deprecated performance.navigation API, if available.
      if (performance.navigation && performance.navigation.type === performance.navigation.TYPE_BACK_FORWARD) {
        window.location.reload();
      }
    </script>
  </head>
  <body>
    <div class="top-bar"></div>

    <div class="tracker-container">
      <div class="progress-bar">
        <p>Energy <span id="energy">0 / 3434 kcal</span></p>
        <div class="bar"></div>
      </div>
      <div class="progress-bar">
        <p>Protein <span id="protein">0 / 172 g</span></p>
        <div class="bar"></div>
      </div>
      <div class="progress-bar">
        <p>Carbs <span id="carbs">0 / 429 g</span></p>
        <div class="bar"></div>
      </div>
      <div class="progress-bar">
        <p>Fat <span id="fat">0 / 115 g</span></p>
        <div class="bar"></div>
      </div>

      <table class="food-table">
        <thead>
          <tr>
            <th>Time</th>
            <th>Food</th>
            <th>Calories</th>
            <th>Protein</th>
            <th>Carbs</th>
            <th>Fat</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <!-- Floating "+" button positioned above the bottom nav -->
      <button class="add-btn" onclick="window.location.href='search.html'">+</button>
    </div>

    <div class="bottom-nav">
      <button class="nav-btn active" onclick="changeTab(event, 'Tracking')">Tracking</button>
      <button class="nav-btn" onclick="window.location.href='nutritionPage.html'">Settings</button>
      <button class="nav-btn" id="logout-btn">Logout</button>
    </div>

    <!-- External scripts -->
    <script src="js/dashboard.js" defer></script>
    <script src="js/index.js" defer></script>
    <script src="js/logout.js" defer></script>
  </body>
</html>
